---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import PostCard from '@components/PostCard.astro';

const posts = (await getCollection('blog'))
  .filter((post) => import.meta.env.PROD ? !post.data.draft : true)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout
  title="Blog | gvns.ca"
  description="Thoughts on homelab, web development, BJJ, and productivity."
>
  <main id="main-content" class="blog-listing">
    <h1>Blog</h1>
    <p class="intro">
      Thoughts on homelab, web development, BJJ, and productivity.
    </p>

    {posts.length > 0 ? (
      <div class="post-list">
        {posts.map((post) => (
          <PostCard post={post} />
        ))}
      </div>
    ) : (
      <p class="no-posts">No posts yet. Check back soon!</p>
    )}
  </main>
</BaseLayout>

<style>
  .blog-listing {
    max-width: var(--width-content);
    margin: 0 auto;
  }

  h1 {
    font-size: 2.25rem;
    margin-bottom: 0.5rem;
  }

  .intro {
    color: var(--color-text-secondary);
    margin-bottom: 2rem;
  }

  .post-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .no-posts {
    color: var(--color-text-secondary);
    font-style: italic;
  }
</style>
